(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{314:function(e,t,r){},441:function(e,t,r){"use strict";var n=r(314);r.n(n).a},551:function(e,t,r){"use strict";r.r(t);r(16);var n=r(2),l=(r(9),{layout:"admin",data:function(){return{results:[],listLoading:!1,page:{},filters:{status:"0"},selectedRows:[],addForm:{forumId:"",userId:"",title:"",content:"",status:"",createTime:""},addFormVisible:!1,addFormRules:{},addLoading:!1,editForm:{id:"",forumId:"",userId:"",title:"",content:"",status:"",createTime:""},editFormVisible:!1,editFormRules:{},editLoading:!1}},mounted:function(){this.list()},methods:{list:function(){var e=this;e.listLoading=!0;var t=Object.assign(e.filters,{page:e.page.page,limit:e.page.limit});this.$axios.post("/api/admin/topic/list",t).then((function(data){e.results=data.results,e.page=data.page})).finally((function(){e.listLoading=!1}))},handlePageChange:function(e){this.page.page=e,this.list()},handleLimitChange:function(e){this.page.limit=e,this.list()},handleAdd:function(){this.addForm={name:"",description:""},this.addFormVisible=!0},addSubmit:function(){var e=this;this.$axios.post("/api/admin/topic/create",this.addForm).then((function(data){e.$message({message:"提交成功",type:"success"}),e.addFormVisible=!1,e.list()})).catch((function(t){e.$notify.error({title:"错误",message:t.message})}))},handleEdit:function(e,t){var r=this;this.$axios.get("/api/admin/topic/".concat(t.id)).then((function(data){r.editForm=Object.assign({},data),r.editFormVisible=!0})).catch((function(e){r.$notify.error({title:"错误",message:e.message})}))},editSubmit:function(){var e=this;this.$axios.post("/api/admin/topic/update",e.editForm).then((function(data){e.list(),e.editFormVisible=!1})).catch((function(t){e.$notify.error({title:"错误",message:t.message})}))},deleteSubmit:function(e){var t=this;this.$confirm("是否确认删除该话题?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$axios.post("/api/admin/topic/delete",{id:e.id}).then((function(){t.$message({message:"删除成功",type:"success"}),t.list()})).catch((function(e){t.$notify.error({title:"错误",message:e.message||e})}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},undeleteSubmit:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,t.$axios.post("/api/admin/topic/undelete",{id:e.id});case 3:t.list(),t.$message({message:"取消删除成功",type:"success"}),r.next=10;break;case 7:r.prev=7,r.t0=r.catch(0),t.$notify.error({title:"错误",message:r.t0.message||r.t0});case 10:case"end":return r.stop()}}),r,null,[[0,7]])})))()},recommend:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,t.$axios.post("/api/admin/topic/recommend",{id:e});case 3:t.$message({message:"推荐成功",type:"success"}),t.list(),r.next=10;break;case 7:r.prev=7,r.t0=r.catch(0),t.$notify.error({title:"错误",message:r.t0.message});case 10:case"end":return r.stop()}}),r,null,[[0,7]])})))()},cancelRecommend:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,t.$axios.delete("/api/admin/topic/recommend",{params:{id:e}});case 3:t.$message({message:"取消推荐成功",type:"success"}),t.list(),r.next=10;break;case 7:r.prev=7,r.t0=r.catch(0),t.$notify.error({title:"错误",message:r.t0.message});case 10:case"end":return r.stop()}}),r,null,[[0,7]])})))()},handleSelectionChange:function(e){this.selectedRows=e}}}),o=(r(441),r(29)),component=Object(o.a)(l,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticClass:"page-container"},[r("div",{staticClass:"toolbar"},[r("el-form",{attrs:{inline:!0,model:e.filters}},[r("el-form-item",[r("el-input",{attrs:{placeholder:"编号"},model:{value:e.filters.id,callback:function(t){e.$set(e.filters,"id",t)},expression:"filters.id"}})],1),e._v(" "),r("el-form-item",[r("el-input",{attrs:{placeholder:"用户编号"},model:{value:e.filters.userId,callback:function(t){e.$set(e.filters,"userId",t)},expression:"filters.userId"}})],1),e._v(" "),r("el-form-item",[r("el-input",{attrs:{placeholder:"标题"},model:{value:e.filters.title,callback:function(t){e.$set(e.filters,"title",t)},expression:"filters.title"}})],1),e._v(" "),r("el-form-item",[r("el-select",{attrs:{clearable:"",placeholder:"是否推荐"},on:{change:e.list},model:{value:e.filters.recommend,callback:function(t){e.$set(e.filters,"recommend",t)},expression:"filters.recommend"}},[r("el-option",{attrs:{label:"推荐",value:"1"}}),e._v(" "),r("el-option",{attrs:{label:"未推荐",value:"0"}})],1)],1),e._v(" "),r("el-form-item",[r("el-select",{attrs:{clearable:"",placeholder:"请选择状态"},on:{change:e.list},model:{value:e.filters.status,callback:function(t){e.$set(e.filters,"status",t)},expression:"filters.status"}},[r("el-option",{attrs:{label:"正常",value:"0"}}),e._v(" "),r("el-option",{attrs:{label:"删除",value:"1"}})],1)],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:e.list}},[e._v("查询")])],1)],1)],1),e._v(" "),r("div",{staticClass:"page-section topics"},e._l(e.results,(function(t){return r("div",{key:t.id,staticClass:"topic"},[r("div",{staticClass:"topic-header"},[r("img",{staticClass:"avatar",attrs:{src:t.user.smallAvatar}}),e._v(" "),r("div",{staticClass:"topic-right"},[r("div",{staticClass:"topic-title"},[r("a",{attrs:{href:"/topic/"+t.id,target:"_blank"}},[e._v(e._s(t.title))])]),e._v(" "),r("div",{staticClass:"topic-meta"},[r("label",[e._v("ID: "+e._s(t.id))]),e._v(" "),t.user?r("label",{staticClass:"author"},[e._v(e._s(t.user.nickname))]):e._e(),e._v(" "),r("label",[e._v(e._s(e._f("formatDate")(t.createTime)))]),e._v(" "),r("label",{staticClass:"node"},[e._v(e._s(t.node?t.node.name:""))]),e._v(" "),e._l(t.tags,(function(t){return r("label",{key:t.tagId,staticClass:"tag"},[e._v(e._s(t.tagName))])})),e._v(" "),r("div",{staticClass:"actions"},[1===t.status?r("span",{staticClass:"action-item danger"},[e._v("已删除")]):e._e(),e._v(" "),0===t.status?r("a",{staticClass:"action-item btn",on:{click:function(r){return e.deleteSubmit(t)}}},[e._v("删除")]):r("a",{staticClass:"action-item btn",on:{click:function(r){return e.undeleteSubmit(t)}}},[e._v("取消删除")]),e._v(" "),t.recommend?r("a",{staticClass:"action-item btn",on:{click:function(r){return e.cancelRecommend(t.id)}}},[e._v("取消推荐")]):r("a",{staticClass:"action-item btn",on:{click:function(r){return e.recommend(t.id)}}},[e._v("推荐")])])],2)])]),e._v(" "),r("div",{staticClass:"summary"},[e._v("\n        "+e._s(t.summary)+"\n      ")])])})),0),e._v(" "),r("div",{staticClass:"pagebar"},[r("el-pagination",{attrs:{"page-sizes":[20,50,100,300],"current-page":e.page.page,"page-size":e.page.limit,total:e.page.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"current-change":e.handlePageChange,"size-change":e.handleLimitChange}})],1),e._v(" "),r("el-dialog",{attrs:{visible:e.addFormVisible,"close-on-click-modal":!1,title:"新增"},on:{"update:visible":function(t){e.addFormVisible=t}}},[r("el-form",{ref:"addForm",attrs:{model:e.addForm,rules:e.addFormRules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"userId",prop:"rule"}},[r("el-input",{model:{value:e.addForm.userId,callback:function(t){e.$set(e.addForm,"userId",t)},expression:"addForm.userId"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"title",prop:"rule"}},[r("el-input",{model:{value:e.addForm.title,callback:function(t){e.$set(e.addForm,"title",t)},expression:"addForm.title"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"content",prop:"rule"}},[r("el-input",{model:{value:e.addForm.content,callback:function(t){e.$set(e.addForm,"content",t)},expression:"addForm.content"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"status",prop:"rule"}},[r("el-input",{model:{value:e.addForm.status,callback:function(t){e.$set(e.addForm,"status",t)},expression:"addForm.status"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"createTime",prop:"rule"}},[r("el-input",{model:{value:e.addForm.createTime,callback:function(t){e.$set(e.addForm,"createTime",t)},expression:"addForm.createTime"}})],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{nativeOn:{click:function(t){e.addFormVisible=!1}}},[e._v("取消")]),e._v(" "),r("el-button",{attrs:{loading:e.addLoading,type:"primary"},nativeOn:{click:function(t){return e.addSubmit(t)}}},[e._v("提交")])],1)],1),e._v(" "),r("el-dialog",{attrs:{visible:e.editFormVisible,"close-on-click-modal":!1,title:"编辑"},on:{"update:visible":function(t){e.editFormVisible=t}}},[r("el-form",{ref:"editForm",attrs:{model:e.editForm,rules:e.editFormRules,"label-width":"80px"}},[r("el-input",{attrs:{type:"hidden"},model:{value:e.editForm.id,callback:function(t){e.$set(e.editForm,"id",t)},expression:"editForm.id"}}),e._v(" "),r("el-form-item",{attrs:{label:"forumId",prop:"rule"}},[r("el-input",{model:{value:e.editForm.forumId,callback:function(t){e.$set(e.editForm,"forumId",t)},expression:"editForm.forumId"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"userId",prop:"rule"}},[r("el-input",{model:{value:e.editForm.userId,callback:function(t){e.$set(e.editForm,"userId",t)},expression:"editForm.userId"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"title",prop:"rule"}},[r("el-input",{model:{value:e.editForm.title,callback:function(t){e.$set(e.editForm,"title",t)},expression:"editForm.title"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"content",prop:"rule"}},[r("el-input",{model:{value:e.editForm.content,callback:function(t){e.$set(e.editForm,"content",t)},expression:"editForm.content"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"status",prop:"rule"}},[r("el-input",{model:{value:e.editForm.status,callback:function(t){e.$set(e.editForm,"status",t)},expression:"editForm.status"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"createTime",prop:"rule"}},[r("el-input",{model:{value:e.editForm.createTime,callback:function(t){e.$set(e.editForm,"createTime",t)},expression:"editForm.createTime"}})],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{nativeOn:{click:function(t){e.editFormVisible=!1}}},[e._v("取消")]),e._v(" "),r("el-button",{attrs:{loading:e.editLoading,type:"primary"},nativeOn:{click:function(t){return e.editSubmit(t)}}},[e._v("提交")])],1)],1)],1)}),[],!1,null,"7d2f4177",null);t.default=component.exports}}]);