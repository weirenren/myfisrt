(window.webpackJsonp=window.webpackJsonp||[]).push([[56],{232:function(t,e,n){},248:function(t,e,n){"use strict";var r={},o=(n(281),n(49)),component=Object(o.a)(r,(function(){var t=this.$createElement;this._self._c;return this._m(0)}),[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"widget markdown-help"},[n("div",{staticClass:"widget-header"},[t._v("\n    Markdown 语法参考\n  ")]),t._v(" "),n("div",{staticClass:"widget-content content"},[n("ol",[n("li",[n("span",{staticStyle:{"font-weight":"700",color:"red"}},[t._v("将图片复制或拖入编辑器可上传")])]),t._v(" "),n("li",[t._v("## 单行的标题")]),t._v(" "),n("li",[t._v("**粗体**")]),t._v(" "),n("li",[t._v("`console.log('行内代码')`")]),t._v(" "),n("li",[t._v("```js\\n code \\n``` 标记代码块")]),t._v(" "),n("li",[t._v("[内容](链接)")]),t._v(" "),n("li",[t._v("![文字说明](图片链接)")])]),t._v(" "),n("span",[n("a",{attrs:{href:"https://mlog.club/article/5522",target:"_blank"}},[t._v("Markdown 文档")])])])])}],!1,null,"29e12336",null);e.a=component.exports},281:function(t,e,n){"use strict";var r=n(232);n.n(r).a},496:function(t,e,n){"use strict";n.r(e);n(22),n(23),n(92),n(16),n(8),n(26);var r=n(39),o=(n(15),n(2)),l=n(200),c=n(242),d=n(248),v=n(241),m=n(327),_={middleware:"authenticated",components:{TagInput:c.a,MarkdownHelp:d.a,PostTweets:v.a},asyncData:function(t){return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,l,c,d,v,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.$axios,o=t.params,e.next=3,Promise.all([n.get("/api/topic/edit/"+o.id),n.get("/api/topic/nodes")]);case 3:return l=e.sent,c=Object(r.a)(l,2),d=c[0],v=c[1],d.extraData=JSON.parse(d.extraData),m=[],d.imageList&&(m=d.imageList.split(",")),console.log("topic:"+JSON.stringify(d)),e.abrupt("return",{topic:d,nodes:v,postForm:{nodeId:d.nodeId,title:d.title,tags:d.tags,content:d.content,imageList:m,extraData:d.extraData}});case 12:case"end":return e.stop()}}),e)})))()},data:function(){return{publishing:!1,imageList:[],postForm:{nodeId:0,title:"",tags:[],content:""}}},computed:{currentUser:function(){return this.$store.state.user.current}},mounted:function(){},methods:{onImageUpload:function(t){this.imageList=t},submitCreate:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=t).publishing){e.next=3;break}return e.abrupt("return");case 3:return n.publishing=!0,e.prev=4,r=m.a.homeItemToJsonString("北京",t.postForm.extraData.address),e.next=8,t.$axios.post("/api/topic/edit/"+t.topic.topicId,{nodeId:t.postForm.nodeId,title:t.postForm.title,content:t.postForm.content,tags:t.postForm.tags?t.postForm.tags.join(","):"",imageList:t.imageList.toString(),extraData:JSON.stringify(r)});case 8:o=e.sent,t.$toast.success("提交成功",{duration:1e3,onComplete:function(){l.a.linkTo("/rent/"+o.topicId)}}),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(4),console.error(e.t0),n.publishing=!1,t.$toast.error("提交失败："+(e.t0.message||e.t0));case 17:case"end":return e.stop()}}),e,null,[[4,12]])})))()}},head:function(){return{title:this.$siteTitle("修改话题")}}},f=n(49),component=Object(f.a)(_,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"main"},[n("div",{staticClass:"container main-container is-white left-main"},[n("div",{staticClass:"left-container"},[n("div",{staticClass:"widget"},[n("div",{staticClass:"widget-header"},[n("nav",{staticClass:"breadcrumb"},[n("ul",[t._m(0),t._v(" "),n("li",[n("a",{attrs:{href:"/user/"+t.currentUser.id+"?tab=topics"}},[t._v(t._s(t.currentUser.nickname))])]),t._v(" "),t._m(1)])])]),t._v(" "),n("div",{staticClass:"widget-content"},[n("div",{staticClass:"field is-horizontal"},[n("div",{staticClass:"field-body"},[n("div",{staticClass:"field",staticStyle:{width:"100%"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.postForm.title,expression:"postForm.title"}],staticClass:"input",attrs:{type:"text",placeholder:"请输入标题"},domProps:{value:t.postForm.title},on:{input:function(e){e.target.composing||t.$set(t.postForm,"title",e.target.value)}}})]),t._v(" "),n("div",{staticClass:"field"},[n("div",{staticClass:"select"},[n("select",{directives:[{name:"model",rawName:"v-model",value:t.postForm.nodeId,expression:"postForm.nodeId"}],on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.postForm,"nodeId",e.target.multiple?n:n[0])}}},[n("option",{attrs:{value:"0"}},[t._v("选择节点")]),t._v(" "),t._l(t.nodes,(function(e){return n("option",{key:e.nodeId,domProps:{value:e.nodeId}},[t._v(t._s(e.name))])}))],2)])])])]),t._v(" "),n("div",{staticClass:"field"},[n("label",{staticClass:"label"},[t._v("详情:")]),t._v(" "),n("div",{staticClass:"control"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.postForm.content,expression:"postForm.content"}],staticClass:"textarea is-large",attrs:{placeholder:"Large textarea"},domProps:{value:t.postForm.content},on:{input:function(e){e.target.composing||t.$set(t.postForm,"content",e.target.value)}}})])]),t._v(" "),n("div",{staticClass:"field"},[n("label",{staticClass:"label"},[t._v("图片:")]),t._v(" "),n("div",{staticClass:"control"},[n("post-tweets",{attrs:{imageList:t.postForm.imageList,onImageUploadCallBack:t.onImageUpload}})],1)]),t._v(" "),n("div",{staticClass:"field"},[n("label",{staticClass:"label"},[t._v("地址:")]),t._v(" "),n("div",{staticClass:"control"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.postForm.extraData.address,expression:"postForm.extraData.address"}],staticClass:"input",attrs:{type:"text",placeholder:"西二旗地铁、回龙观"},domProps:{value:t.postForm.extraData.address},on:{input:function(e){e.target.composing||t.$set(t.postForm.extraData,"address",e.target.value)}}})])]),t._v(" "),n("div",{staticClass:"field"},[n("div",{staticClass:"control"},[n("tag-input",{model:{value:t.postForm.tags,callback:function(e){t.$set(t.postForm,"tags",e)},expression:"postForm.tags"}})],1)]),t._v(" "),n("div",{staticClass:"field is-grouped"},[n("div",{staticClass:"control"},[n("a",{staticClass:"button is-success",class:{"is-loading":t.publishing},attrs:{disabled:t.publishing},on:{click:t.submitCreate}},[t._v("提交更改")])])])])])]),t._v(" "),n("div",{staticClass:"right-container"},[n("markdown-help")],1)])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("li",[e("a",{attrs:{href:"/"}},[this._v("首页")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",{staticClass:"is-active"},[e("a",{attrs:{href:"#","aria-current":"page"}},[this._v("主题")])])}],!1,null,"1846d340",null);e.default=component.exports}}]);