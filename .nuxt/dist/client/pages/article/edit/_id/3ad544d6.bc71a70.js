(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{493:function(t,e,r){"use strict";r.r(e);r(16),r(8),r(26);var n=r(39),o=(r(15),r(2)),c=r(200),l=r(242),d=r(248),m=r(267),v={middleware:"authenticated",components:{TagInput:l.a,MarkdownHelp:d.a,MarkdownEditor:m.a},asyncData:function(t){return Object(o.a)(regeneratorRuntime.mark((function e(){var r,o,c,l,d,article;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.$axios,o=t.params,c=t.error,e.prev=1,e.next=4,Promise.all([r.get("/api/article/edit/"+o.id)]);case 4:return l=e.sent,d=Object(n.a)(l,1),article=d[0],e.abrupt("return",{article:article,postForm:{title:article.title,tags:article.tags,content:article.content}});case 10:e.prev=10,e.t0=e.catch(1),c({statusCode:403,message:e.t0.message||"403"});case 13:case"end":return e.stop()}}),e,null,[[1,10]])})))()},data:function(){return{publishing:!1,postForm:{title:"",tags:[],content:""}}},computed:{currentUser:function(){return this.$store.state.user.current}},methods:{submitCreate:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var r,article;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=t).publishing){e.next=3;break}return e.abrupt("return");case 3:return r.publishing=!0,e.prev=4,e.next=7,t.$axios.post("/api/article/edit/"+t.article.articleId,{title:t.postForm.title,content:t.postForm.content,tags:t.postForm.tags?t.postForm.tags.join(","):""});case 7:article=e.sent,t.$toast.success("修改成功",{duration:2e3,onComplete:function(){c.a.linkTo("/article/"+article.articleId)}}),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(4),console.error(e.t0),r.publishing=!1,t.$toast.error("提交失败："+(e.t0.message||e.t0));case 16:case"end":return e.stop()}}),e,null,[[4,11]])})))()}},head:function(){return{title:this.$siteTitle("修改文章")}}},f=r(49),component=Object(f.a)(v,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("section",{staticClass:"main"},[r("div",{staticClass:"container main-container is-white left-main"},[r("div",{staticClass:"left-container"},[r("div",{staticClass:"widget"},[r("div",{staticClass:"widget-header"},[r("nav",{staticClass:"breadcrumb"},[r("ul",[t._m(0),t._v(" "),r("li",[r("a",{attrs:{href:"/user/"+t.currentUser.id+"?tab=topics"}},[t._v(t._s(t.currentUser.nickname))])]),t._v(" "),t._m(1)])])]),t._v(" "),r("div",{staticClass:"widget-content"},[r("div",{staticClass:"field"},[r("div",{staticClass:"control"},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.postForm.title,expression:"postForm.title"}],staticClass:"input",attrs:{type:"text",placeholder:"标题"},domProps:{value:t.postForm.title},on:{input:function(e){e.target.composing||t.$set(t.postForm,"title",e.target.value)}}})])]),t._v(" "),r("div",{staticClass:"field"},[r("div",{staticClass:"control"},[r("markdown-editor",{attrs:{"editor-id":"articleEditEditor",placeholder:"请输入内容，将图片复制或拖入编辑器可上传"},model:{value:t.postForm.content,callback:function(e){t.$set(t.postForm,"content",e)},expression:"postForm.content"}})],1)]),t._v(" "),r("div",{staticClass:"field"},[r("div",{staticClass:"control"},[r("tag-input",{model:{value:t.postForm.tags,callback:function(e){t.$set(t.postForm,"tags",e)},expression:"postForm.tags"}})],1)]),t._v(" "),r("div",{staticClass:"field is-grouped"},[r("div",{staticClass:"control"},[r("a",{staticClass:"button is-success",class:{"is-loading":t.publishing},attrs:{disabled:t.publishing},on:{click:t.submitCreate}},[t._v("提交更改")])])])])])]),t._v(" "),r("div",{staticClass:"right-container"},[r("markdown-help")],1)])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("li",[e("a",{attrs:{href:"/"}},[this._v("首页")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",{staticClass:"is-active"},[e("a",{attrs:{href:"#","aria-current":"page"}},[this._v("文章")])])}],!1,null,"ea11137a",null);e.default=component.exports}}]);