/*! For license information please see ../../../LICENSES */
(window.webpackJsonp=window.webpackJsonp||[]).push([[61],{208:function(t,e,n){"use strict";n(93),n(23),n(24),n(9);var o=n(91),r=n(92),c=n(211),l=n.n(c),h=function(){function t(){Object(o.a)(this,t)}return Object(r.a)(t,[{key:"getCity",value:function(){var t=l.a.get("city");return void 0!==t?t:"北京"}},{key:"setCity",value:function(t){return l.a.set("city",t)}},{key:"linkTo",value:function(path){window.location=path}},{key:"toSignin",value:function(t){t||(t=window.location.pathname),this.linkTo("/user/signin?ref="+encodeURIComponent(t))}},{key:"isSigninUrl",value:function(t){return"/user/signin"===t}},{key:"isArray",value:function(t){return"[object Array]"===Object.prototype.toString.call(t)}},{key:"isDate",value:function(t){return"[object Date]"==={}.toString.call(t)&&"Invalid Date"!==t.toString()&&!isNaN(t)}},{key:"isElement",value:function(t){return!(!t||!t.nodeName||1!==t.nodeType)}},{key:"isFunction",value:function(t){return"[object Function]"===Object.prototype.toString.call(t)}},{key:"unique",value:function(t){return t.filter((function(t,e,n){return n.indexOf(t,0)===e}))}},{key:"isNumber",value:function(t){return"[object Number]"===Object.prototype.toString.call(t)&&isFinite(t)}},{key:"isObject",value:function(t){return"[object Object]"===Object.prototype.toString.call(t)}},{key:"isString",value:function(t){return"[object String]"===Object.prototype.toString.call(t)}},{key:"isBoolean",value:function(t){return"boolean"==typeof t}},{key:"getCityList",value:function(){return["北京","上海","深圳","武汉","杭州"]}},{key:"isEmpty",value:function(content){var t=content;if(""===t||void 0===t)return!0;return new RegExp("^[ ]+$").test(t)}},{key:"getTopText",value:function(t){return 1===t?"顶":2===t?"火":3===t?"精华":""}}]),t}();e.a=new h},209:function(t,e,n){},217:function(t,e,n){"use strict";var o=n(209);n.n(o).a},218:function(t,e,n){"use strict";n(137);var o={props:{currentNodeId:{type:Number,default:1},nodes:{type:Array,default:function(){return[]}}},mounted:function(){}},r=(n(217),n(29)),component=Object(r.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"topics-nav"},[n("ul",{staticClass:"topics-nav-list"},[n("li",{staticClass:"topics-nav-item",class:{active:0===t.currentNodeId}},[n("a",{attrs:{href:"/topics/node/newest"}},[t._v("最新")])]),t._v(" "),n("li",{staticClass:"topics-nav-item",class:{active:-1===t.currentNodeId}},[n("a",{attrs:{href:"/topics/node/recommend"}},[t._v("推荐")])]),t._v(" "),t._l(t.nodes,(function(e){return n("li",{key:e.nodeId,staticClass:"topics-nav-item",class:{active:t.currentNodeId==e.nodeId}},[1!==e.nodeId&&2!==e.nodeId?n("div",[n("a",{attrs:{href:"/topics/node/"+e.nodeId}},[t._v(t._s(e.name))])]):t._e()])}))],2)])}),[],!1,null,"1f0f6714",null);e.a=component.exports},219:function(t,e,n){"use strict";n(16);var o=n(2),r=(n(232),n(228)),c=n(230),l=n(231),h=n(208);r.c.add(l.b,l.a);var d={components:{},props:{id:{type:String},title:{type:String,required:!1},onCollapsed:{type:Function,required:!1}},data:function(){return{isCollapsed:!0}},watch:{isCollapsed:function(t){this.onCollapsed&&this.onCollapsed(t)}},mounted:function(){this.id},methods:{getCollapseState:function(){return this.isCollapsed},saveCollapsedState:function(t){console.log(t);this.getCollapseState()}}},f=(n(246),n(29));Object(f.a)(d,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card"},[n("header",{staticClass:"card-header"},[t._t("title")],2),t._v(" "),n("div",{staticClass:"card-content",class:{"is-hidden":t.isCollapsed}},[t.isCollapsed?t._e():t._t("default")],2),t._v(" "),t.isCollapsed?t._e():n("footer",{staticClass:"card-footer"},[t._t("footer")],2)])}),[],!1,null,"fe043d22",null).exports;r.c.add(l.b,l.a);var m={components:{FontAwesomeIcon:c.a},props:{topics:{type:Array,default:function(){return[]},required:!1},showAd:{type:Boolean,default:!1},openNewPage:{type:Boolean,default:!1}},data:function(){return{blank:"",isCollapsed:!0,isCollapsedArray:[]}},watch:{topics:function(t,e){this.topics&&void 0!==this.topics.length&&(this.isCollapsedArray=new Array(this.topics.length).fill(!0))}},mounted:function(){this.openNewPage&&(this.blank="_blank"),this.topics&&this.topics.length>0&&(this.isCollapsedArray=new Array(this.topics.length).fill(!0))},methods:{clickCollapse:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(void 0===e.topics[t].content){n.next=3;break}n.next=12;break;case 3:return n.prev=3,n.next=6,e.$axios.get("/api/topic/"+e.topics[t].topicId);case 6:o=n.sent,e.topics[t].content=o.content,n.next=12;break;case 10:n.prev=10,n.t0=n.catch(3);case 12:e.$set(e.isCollapsedArray,t,!e.isCollapsedArray[t]);case 13:case"end":return n.stop()}}),n,null,[[3,10]])})))()},getTopText:function(t){var e=t.topType?t.topType:0;return h.a.getTopText(e)},onCollapseBack:function(t){console.log(t)},like:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.isCollapsed=!e.isCollapsed,n.prev=1,n.next=4,e.$axios.post("/api/topic/like/"+t.topicId);case 4:t.liked=!0,t.likeCount++,n.next=11;break;case 8:n.prev=8,n.t0=n.catch(1),1===n.t0.errorCode?e.$toast.info("请登录后点赞！！！",{action:{text:"去登录",onClick:function(t,e){h.a.toSignin()}}}):e.$toast.error(n.t0.message||n.t0);case 11:case"end":return n.stop()}}),n,null,[[1,8]])})))()}}},v=(n(247),Object(f.a)(m,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ul",{staticClass:"topic-list topic-wrap"},t._l(t.topics,(function(e,o){return n("li",{key:e.topicId,staticClass:"topic-item",attrs:{index:o}},[n("article",{attrs:{itemscope:"",itemtype:"http://schema.org/BlogPosting"}},[n("div",{staticClass:"topic-header"},[n("div",{staticClass:"topic-header-left"},[n("a",{attrs:{href:"/user/"+e.user.id,title:e.user.nickname}},[n("img",{staticClass:"avatar",attrs:{src:e.user.smallAvatar}})])]),t._v(" "),n("div",{staticClass:"topic-header-center"},[n("h1",{staticClass:"topic-title",attrs:{itemprop:"headline"}},[e.node&&2===e.node.nodeId?n("a",{attrs:{target:t.blank,href:"/rent/"+e.topicId,title:e.title}},[t._v(t._s(e.title))]):e.node&&1===e.node.nodeId?n("a",{attrs:{target:t.blank,href:"/love/"+e.topicId,title:e.title}},[t._v(t._s(e.title))]):n("a",{attrs:{target:t.blank,href:"/topic/"+e.topicId,title:e.title}},[t._v(t._s(e.title))]),t._v(" "),n("span",{class:0!==e.topType?"text-top":""},[t._v(t._s(t.getTopText(e)))])]),t._v(" "),n("div",{staticClass:"topic-meta"},[n("span",{staticClass:"meta-item"},[n("time",{attrs:{datetime:t._f("formatDate")(e.createTime,"yyyy-MM-ddTHH:mm:ss"),itemprop:"datePublished"}},[t._v(t._s(t._f("prettyDate")(e.createTime)))])]),t._v(" "),n("span",{staticClass:"meta-item"}),t._v(" "),n("span",{staticClass:"meta-item"},[t._l(e.tags,(function(e){return n("span",{key:e.tagName+e.tagId,staticClass:"tag"},[n("a",[t._v(t._s(e.tagName))])])})),t._v(" "),e.node&&2===e.node.nodeId?n("span",{attrs:{target:t.blank}},[n("a",{staticClass:"tag",on:{click:function(e){return t.clickCollapse(o)}}},[t._v("展开 \n                  "),t.isCollapsedArray[o]?t._e():n("font-awesome-icon",{attrs:{icon:"angle-down"}}),t._v(" "),t.isCollapsedArray[o]?n("font-awesome-icon",{attrs:{icon:"angle-up"}}):t._e()],1)]):t._e()],2)])]),t._v(" "),n("div",{staticClass:"topic-header-right"},[n("div",{staticClass:"like"},[n("span",{staticClass:"like-btn",class:{liked:e.liked},on:{click:function(n){return t.like(e)}}},[n("i",{staticClass:"iconfont icon-like"})]),t._v(" "),e.likeCount?n("span",{staticClass:"like-count"},[t._v(t._s(e.likeCount))]):t._e()]),t._v(" "),n("span",{staticClass:"count"},[t._v(t._s(e.commentCount)+" / "+t._s(e.viewCount))])])]),t._v(" "),n("div",{staticClass:"card-content",class:{"is-hidden":t.isCollapsedArray[o]}},[n("div",{staticStyle:{"font-size":"12px",color:"black"},domProps:{innerHTML:t._s(e.content)}})])])])})),0)}),[],!1,null,"5f70d366",null));e.a=v.exports},222:function(t,e,n){},223:function(t,e,n){},232:function(t,e,n){var o=n(6);o(o.P,"Array",{fill:n(233)}),n(94)("fill")},233:function(t,e,n){"use strict";var o=n(32),r=n(138),c=n(19);t.exports=function(t){for(var e=o(this),n=c(e.length),l=arguments.length,h=r(l>1?arguments[1]:void 0,n),d=l>2?arguments[2]:void 0,f=void 0===d?n:r(d,n);f>h;)e[h++]=t;return e}},240:function(t,e,n){"use strict";e.parse=function(t,e){if("string"!=typeof t)throw new TypeError("argument str must be a string");for(var n={},r=e||{},l=t.split(c),d=r.decode||o,i=0;i<l.length;i++){var f=l[i],m=f.indexOf("=");if(!(m<0)){var v=f.substr(0,m).trim(),y=f.substr(++m,f.length).trim();'"'==y[0]&&(y=y.slice(1,-1)),null==n[v]&&(n[v]=h(y,d))}}return n},e.serialize=function(t,e,n){var o=n||{},c=o.encode||r;if("function"!=typeof c)throw new TypeError("option encode is invalid");if(!l.test(t))throw new TypeError("argument name is invalid");var h=c(e);if(h&&!l.test(h))throw new TypeError("argument val is invalid");var d=t+"="+h;if(null!=o.maxAge){var f=o.maxAge-0;if(isNaN(f)||!isFinite(f))throw new TypeError("option maxAge is invalid");d+="; Max-Age="+Math.floor(f)}if(o.domain){if(!l.test(o.domain))throw new TypeError("option domain is invalid");d+="; Domain="+o.domain}if(o.path){if(!l.test(o.path))throw new TypeError("option path is invalid");d+="; Path="+o.path}if(o.expires){if("function"!=typeof o.expires.toUTCString)throw new TypeError("option expires is invalid");d+="; Expires="+o.expires.toUTCString()}o.httpOnly&&(d+="; HttpOnly");o.secure&&(d+="; Secure");if(o.sameSite){switch("string"==typeof o.sameSite?o.sameSite.toLowerCase():o.sameSite){case!0:d+="; SameSite=Strict";break;case"lax":d+="; SameSite=Lax";break;case"strict":d+="; SameSite=Strict";break;case"none":d+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return d};var o=decodeURIComponent,r=encodeURIComponent,c=/; */,l=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function h(t,e){try{return e(t)}catch(e){return t}}},246:function(t,e,n){"use strict";var o=n(222);n.n(o).a},247:function(t,e,n){"use strict";var o=n(223);n.n(o).a},272:function(t,e,n){"use strict";var o={},r=n(29),component=Object(r.a)(o,(function(){var t=this.$createElement;this._self._c;return this._m(0)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"content has-text-centered"},[e("p",[e("span",{staticStyle:{"font-size":"13px",color:"gray"}},[this._v("------ 无 ------ ")])])])}],!1,null,"81124340",null);e.a=component.exports},296:function(t,e,n){},297:function(t,e,n){"use strict";var o=n(91),r=n(92),c=(n(208),function(){function t(){Object(o.a)(this,t)}return Object(r.a)(t,[{key:"getStorage",value:function(){return window.localStorage}},{key:"setConfigVersion",value:function(t){this.setItem("vcode",t)}},{key:"getConfigVersion",value:function(){return this.getItem("vcode")}},{key:"getCurrentCity",value:function(){return this.getItem("city")}},{key:"setCurrentCity",value:function(t){this.setItem("city",t)}},{key:"setSubwayAndRegion",value:function(t,e){this.setItem(t+"_subway_region",e)}},{key:"getSubwayAndRegion",value:function(t){return this.getItem(t+"_subway_region")}},{key:"getStationList",value:function(t,e,n){return this.getItem(t+"_"+e+"_"+n)}},{key:"setStationList",value:function(t,e,n,o){this.setItem(t+"_"+e+"_"+n,o)}},{key:"getItem",value:function(t){var e=this.getStorage();try{return JSON.parse(e.getItem(t))}catch(t){return null}}},{key:"setItem",value:function(t,e){this.getStorage().setItem(t,JSON.stringify(e))}},{key:"removeItem",value:function(t){this.getStorage().removeItem(t)}},{key:"clear",value:function(){this.getStorage().clear()}}]),t}());e.a=new c},298:function(t,e,n){},299:function(t,e,n){},300:function(t,e,n){"use strict";n(69);var o=n(91),r=n(92),c=n(208),l=n(369),h=function(){function t(){Object(o.a)(this,t)}return Object(r.a)(t,[{key:"convertLatlonToGeohash",value:function(t){return l.encode(t[0],t[1],11)}},{key:"getLatlonFromGeoRequest",value:function(t){var e="",n="",o="";if(t.geocodes.length>0){var r=t.geocodes[0];if(void 0!==r.location){o=r.district;var c=r.location.split(",");e=this.convertLatlonToGeohash(c),n=r.location}}return{geohash:e,latlon:n,district:o}}},{key:"requestAmapGeo",value:function(t,address,e){var n="/v3/geocode/geo?key=06a39860cdf741c5dc5ba1242112ab72&city="+c.a.getCity()+"&address="+address;t.get(n).then((function(t){})).catch((function(t){e&&e(t)}))}},{key:"hasRole",value:function(t,e){if(!t||!t.roles||!t.roles.length)return!1;for(var i=0;i<t.roles.length;i++)if(t.roles[i]===e)return!0;return!1}},{key:"hasAnyRole",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];if(!n||!n.length)return!1;for(var i=0;i<n.length;i++)if(this.hasRole(t,n[i]))return!0;return!1}},{key:"isOwner",value:function(t){return this.hasRole(t,"owner")}},{key:"isAdmin",value:function(t){return this.hasRole(t,"admin")}}]),t}();e.a=new h},309:function(t,e,n){},377:function(t,e){},378:function(t,e){},410:function(t,e,n){"use strict";var o=n(296);n.n(o).a},411:function(t,e,n){"use strict";var o=n(298);n.n(o).a},412:function(t,e,n){"use strict";var o=n(299);n.n(o).a},429:function(t,e,n){"use strict";var o=n(309);n.n(o).a},537:function(t,e,n){"use strict";n.r(e);n(18),n(17),n(9),n(30);var o=n(41),r=(n(16),n(2)),c=n(228),l=n(230),h=n(231),d=n(240),f=n.n(d),m={props:{page:{type:Object,default:function(){return{page:1,total:0,limit:20}},required:!0},urlPrefix:{type:String,default:"/",required:!0},parmsContext:{type:Object,default:function(){return{}},required:!1},onPageChanged:{type:Function,required:!0}},computed:{pageList:function(){var t=this.page.page-2,e=this.page.page+2,n=this.getTotalPage();if(t<=0){for(var o=[],i=1;i<=5&&i<=n;i++)o.push(i);return o}if(e>n){for(var r=[],c=n-5<=0?1:n-5;c>0&&c<=n;c++)r.push(c);return r}return[this.page.page-2,this.page.page-1,this.page.page,this.page.page+1,this.page.page+2]},previousPageUrl:function(){return this.getPreviousPageUrl()},nextPageUrl:function(){return this.getNextPageUrl()}},mounted:function(){},methods:{getNextPageUrl:function(){var t=this.page.page+1;return t>this.getTotalPage()?"":this.getPageUrl(t)},clickNextPage:function(){var t=this.page.page+1;t>this.getTotalPage()||this.clickPage(t)},clickPreviousPage:function(){var t=this.page.page-1;t<=0||this.clickPage(t)},getPreviousPageUrl:function(){var t=this.page.page-1;return t<=0?"":this.getPageUrl(t)},getPageUrl:function(t){return this.page.page===t?"javascript:void(0)":this.urlPrefix+t},clickPage:function(t){this.page.page===t||this.onPageChanged&&this.onPageChanged(this.urlPrefix,t,this.parmsContext)},getTotalPage:function(){return this.page.total%this.page.limit>0?parseInt(this.page.total/this.page.limit)+1:this.page.total/this.page.limit}}},v=(n(410),n(29)),y=Object(v.a)(m,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.page.total>0?n("nav",{staticClass:"pagination is-small",attrs:{role:"navigation","aria-label":"pagination"}},[t.previousPageUrl?n("a",{staticClass:"pagination-previous",on:{click:t.clickPreviousPage}},[t._v("上一页")]):n("a",{staticClass:"pagination-previous",attrs:{disabled:""}},[t._v("上一页")]),t._v(" "),t.nextPageUrl?n("a",{staticClass:"pagination-previous",on:{click:t.clickNextPage}},[t._v("下一页")]):n("a",{staticClass:"pagination-previous",attrs:{disabled:""}},[t._v("下一页")]),t._v(" "),n("ul",{staticClass:"pagination-list"},t._l(t.pageList,(function(p){return n("li",{key:p},[n("a",{staticClass:"pagination-link",class:{"is-current":p==t.page.page},on:{click:function(e){return t.clickPage(p)}}},[t._v(t._s(p))])])})),0)]):t._e()}),[],!1,null,"9858bd7c",null).exports,C=n(297),_=n(208),S={components:{},props:{subwaysAndRegions:{type:Array,default:function(){return[]},required:!0},onParentStationChanged:{type:Function,required:!0},onChildStationChanged:{type:Function,required:!0},onTabChanged:{type:Function,required:!1}},data:function(){return{subways:[{name:"不限",id:-1}],regions:[{name:"不限",id:-1}],dtype:0,tabIndex:0,metroIndex:0,sectionIndex:0,addressIndex:0,isCollapsed:!0,geoStationIndex:0,geoStationListAction:"/api/topic/stationlist",geoStationList:[{name:"不限",id:-1}],showDetailView:!1}},watch:{isCollapsed:function(t){this.onCollapsed&&this.onCollapsed(t)}},mounted:function(){var t=this;this.id,this.subwaysAndRegions&&this.subwaysAndRegions.forEach((function(e){0===e.dtype?t.subways.push({name:e.name,id:e.dataId}):t.regions.push({name:e.name,id:e.dataId})}))},methods:{metroIndexChanged:function(t){this.metroIndex=t,this.geoStationIndex=0;var e=this.subways[t];this.onParentStationChanged&&this.onParentStationChanged(this.dtype,e),this.requestStationList(this.dtype,e.id,_.a.getCity())},childStationChanged:function(t){if(this.geoStationIndex=t,this.onChildStationChanged){var e=this.geoStationList[t],n=0===this.tabIndex?this.subways[this.metroIndex]:this.regions[this.sectionIndex];this.onChildStationChanged(this.dtype,e,n)}},sectionIndexChanged:function(t){this.sectionIndex=t,this.geoStationIndex=0;var e=this.regions[t];this.onParentStationChanged&&this.onParentStationChanged(this.dtype,e),this.requestStationList(this.dtype,e.id,_.a.getCity())},requestStationList:function(t,e,n){var o=this,r={dtype:t,dataId:e,city:n},c=C.a.getStationList(n,t,e);c?(this.geoStationList=[{name:"不限",id:-1}],Array.prototype.push.apply(this.geoStationList,c)):this.$axios.get(this.geoStationListAction,{params:r}).then((function(r){o.geoStationList=[{name:"不限",id:-1}],Array.prototype.push.apply(o.geoStationList,r),o.geoStationList&&o.geoStationList.length>0&&C.a.setStationList(n,t,e,r)})).catch((function(t){console.log("tagSearchTopics error:"+JSON.stringify(t))}))},tabChanged:function(t){this.tabIndex=t,this.dtype=t,this.geoStationList=[],this.metroIndex=0,this.sectionIndex=0,this.onTabChanged&&this.onTabChanged(t),this.changeDetailView()},getCollapseState:function(){return this.isCollapsed},changeDetailView:function(){0===this.tabIndex&&(this.showDetailView=0!==this.metroIndex),1===this.tabIndex&&(this.showDetailView=0!==this.metroIndex)},saveCollapsedState:function(t){this.getCollapseState()}}},x=(n(411),Object(v.a)(S,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"metro-body"},[n("div",{staticClass:"tabs is-small is-toggle metro-tabs"},[n("ul",[n("li",{class:0===t.tabIndex?"is-active":""},[n("a",{on:{click:function(e){return t.tabChanged(0)}}},[n("span",[t._v("地铁线路")])])]),t._v(" "),n("li",{class:1===t.tabIndex?"is-active":""},[n("a",{on:{click:function(e){return t.tabChanged(1)}}},[n("span",[t._v("行政区域")])])])])]),t._v(" "),0===t.tabIndex?n("div",[n("div",{staticClass:"metro-action-content"},[n("div",{staticClass:"metro-label"},[t._v("\n        地铁\n      ")]),t._v(" "),n("div",t._l(t.subways,(function(e,o){return n("a",{key:e.name,class:o===t.metroIndex?"metro-a":"",attrs:{index:o},on:{click:function(e){return t.metroIndexChanged(o)}}},[t._v("\n          "+t._s(e.name))])})),0)])]):t._e(),t._v(" "),1===t.tabIndex?n("div",{staticClass:"metro-action-content"},[n("div",{staticClass:"metro-label"},[t._v("\n      区域\n    ")]),t._v(" "),n("div",t._l(t.regions,(function(e,o){return n("a",{key:e.name,class:o===t.sectionIndex?"metro-a":"",attrs:{index:o},on:{click:function(e){return t.sectionIndexChanged(o)}}},[t._v("\n        "+t._s(e.name))])})),0)]):t._e(),t._v(" "),t.metroIndex>0||t.sectionIndex>0?n("div",{staticClass:"metro-a-container"},t._l(t.geoStationList,(function(e,o){return n("a",{key:e.id,class:o===t.geoStationIndex?"metro-a":"",attrs:{index:o},on:{click:function(e){return t.childStationChanged(o)}}},[t._v("\n      "+t._s(e.name))])})),0):t._e()])}),[],!1,null,"45b97f9e",null).exports),P=(n(218),n(219)),w=(n(137),{components:{},props:{geoHash:{type:String,default:"",required:!0},dtype:{type:Number,default:0,required:!0},geoStationId:{type:Number,default:0,required:!0},onRecommendStationChanged:{type:Function,required:!0}},data:function(){return{rentRecommentAction:"/api/topic/geostation/recommend",topicsPage:{},pageParmsContext:{},regions:[],sectionIndex:-1,showRecommendDiv:!1}},mounted:function(){this.requestRentRecomment(this.geoHash,1,this.dtype)},methods:{getRentRecommentParms:function(t,e){return{city:_.a.getCity(),geoHash:this.geoHash}},sectionIndexChanged:function(t){this.sectionIndex=t,this.geoStationIndex=0;var e=this.regions[t];this.onRecommendStationChanged&&this.onRecommendStationChanged(this.dtype,e.geoStationId)},requestRentRecomment:function(t,e,n){var o=this,r=this.getRentRecommentParms(e,n);this.$axios.get(this.rentRecommentAction,{params:r}).then((function(t){if(t.length>0){var e=[];t.forEach((function(element){element.geoStationId!==o.geoStationId&&""!==element.geoHash&&e.push(element)})),o.regions=_.a.unique(e),o.showRecommendDiv=e.length>0}else o.showRecommendDiv=!1})).catch((function(t){console.log("recommend error:"+JSON.stringify(t))}))},doAjax:function(){},onCancel:function(){console.log("User cancelled the loader.")}}}),k=(n(412),Object(v.a)(w,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"metro-body",attrs:{"v-if":t.showRecommendDiv}},[n("div",{staticClass:"metro-action-content"},[n("div",{staticClass:"metro-label"},[t._v("\n      附近5公里内推荐:\n    ")]),t._v(" "),t.regions&&t.regions.length>0?n("div",t._l(t.regions,(function(e,o){return n("a",{key:e.geoStationId+e.pname+e.name,class:o===t.sectionIndex?"metro-a":"",attrs:{index:o},on:{click:function(e){return t.sectionIndexChanged(o)}}},[t._v("\n        "+t._s(e.pname)+"-"+t._s(e.name))])})),0):n("div",{},[n("a",[t._v("无")])])])])}),[],!1,null,"96f2d9e6",null).exports),I=n(300),A=n(272);c.c.add(h.b,h.a);var R={components:{FontAwesomeIcon:l.a,RentRecommend:k,TopicList:P.a,Pagination2:y,MetroSelector:x,NoTip:A.a},asyncData:function(t){return Object(r.a)(regeneratorRuntime.mark((function e(){var n,r,c,l,h,d,m,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.$axios,r=t.query,t.req,c="北京",n.defaults.headers.common.cookie?(l=f.a.parse(n.defaults.headers.common.cookie||""))&&""!==l&&(c=l.city):c=_.a.getCity(),e.prev=3,e.next=6,Promise.all([n.get("/api/topic/rent/topics",{params:{page:r.p||1,city:c,nodeId:2}}),n.get("/api/topic/subway",{params:{city:c}})]);case 6:return h=e.sent,d=Object(o.a)(h,2),m=d[0],v=d[1],e.abrupt("return",{topicsPage:m,subwaysAndRegions:v});case 13:e.prev=13,e.t0=e.catch(3),console.error(e.t0);case 16:case"end":return e.stop()}}),e,null,[[3,13]])})))()},data:function(){return{searchTerms:"",searchAction:!1,rentPagingAction:"/api/topic/rent/topics",geoPagingAction:"/api/topic/geo/topics",fullGeoPagingAction:"/api/topic/full/geo/topics",pageAction:"",pageParmsContext:{},showMetraDiv:!1,selectStation:{},showRentRecommentDiv:!1,dtype:0}},mounted:function(){"武汉"===_.a.getCity()&&(this.showMetraDiv=!0,this.jumpCityUrl="https://sharevideo.cn/rent/6183"),"北京"===_.a.getCity()&&(this.showMetraDiv=!0,this.jumpCityUrl="https://sharevideo.cn/rent/6346"),"杭州"===_.a.getCity()&&(this.bannerImgurl="https://upload-images.jianshu.io/upload_images/17856673-382c2bfa30d1d02f.JPG",this.jumpCityUrl="https://sharevideo.cn/rent/6183"),"上海"===_.a.getCity()&&(this.jumpCityUrl="https://sharevideo.cn/rent/6347"),this.pageAction=this.rentPagingAction},methods:{onPageChanged:function(t,e,n){var o={};t===this.rentPagingAction&&(o=this.getNodeTopicParms(e)),t===this.fullGeoPagingAction&&(o=this.getRentParms(this.dtype,e,this.pageParmsContext.dataId)),t===this.geoPagingAction&&(o=this.getGeoStationParms(e,this.pageParmsContext.geoStationId)),this.changePageTopics(t,o,null),setTimeout((function(){window.scrollTo({top:0,left:0,behavior:"smooth"})}),300)},getSelectStationObject:function(t){return{geoStationId:-1,geoHash:t}},getRentParms:function(t,e,n){return{page:e||1,city:_.a.getCity(),dataId:n,dtype:t}},getNodeTopicParms:function(t){return{page:t||1,city:_.a.getCity(),nodeId:2}},getGeoStationParms:function(t,e,n){return{page:e||1,city:_.a.getCity(),geoStationId:n,dtype:t}},onChildStationChanged:function(t,e,n){var o=this;"不限"===e.name?(this.showRentRecommentDiv=!1,this.onParentStationChanged(t,n)):(this.showRentRecommentDiv=!0,this.refreshRentRecommend(),this.selectStation=e,this.pageAction=this.geoPagingAction,this.pageParmsContext=this.getGeoStationParms(t,1,e.geoStationId),this.changePageTopics(this.geoPagingAction,this.pageParmsContext,(function(){o.refreshPagination()})))},onRecommendStationChanged:function(t,e){var n=this;this.pageAction=this.geoPagingAction,this.pageParmsContext=this.getGeoStationParms(t,1,e),this.changePageTopics(this.geoPagingAction,this.pageParmsContext,(function(){n.refreshPagination()}))},onParentStationChanged:function(t,e){var n=this;this.dtype=t,this.showRentRecommentDiv=!1,"不限"===e.name?this.changePageTopics(this.rentPagingAction,this.getNodeTopicParms(1),null):(this.pageAction=this.fullGeoPagingAction,this.pageParmsContext=this.getRentParms(t,1,e.id),this.changePageTopics(this.fullGeoPagingAction,this.pageParmsContext,(function(){n.refreshPagination()})))},onTabChanged:function(t){(this.rentPagingAction!==this.pageAction||this.topicsPage.page.page>1)&&this.changePageTopics(this.rentPagingAction,this.getNodeTopicParms(1),null)},onCollapseBack:function(t){},jumpCityWechatUrl:function(){window.location.href=this.jumpCityUrl},jumpUrl:function(t){t&&window.open(t)},twitterCreated:function(data){this.topicsPage&&(this.topicsPage.results?this.topicsPage.results.unshift(data):this.topicsPage.results=[data])},changePageTopics:function(t,e,n){var o=this;this.pageAction=t,this.$axios.get(t,{params:e}).then((function(t){o.topicsPage.results=t.results,o.topicsPage.page=t.page,n&&n()})).catch((function(t){console.log("tagSearchTopics error:"+JSON.stringify(t))}))},refreshPagination:function(){var t=this,e=this.searchAction;this.searchAction=!this.searchAction,this.$nextTick((function(){t.searchAction=e}))},refreshRentRecommend:function(){var t=this,e=this.showRentRecommentDiv;this.showRentRecommentDiv=!this.showRentRecommentDiv,this.$nextTick((function(){t.showRentRecommentDiv=e}))},geoSearchTopics:function(t){var e=this;this.pageAction=this.geoPagingAction,this.pageParmsContext={page:1,geoStationId:t.id},this.changePageTopics(this.geoPagingAction,this.pageParmsContext,(function(){e.refreshPagination()}))},search:function(){var t=this,e=this.searchTerms.trim();if(_.a.isEmpty(e))this.$toast.error("请输入租房地点");else{var n=this;I.a.requestAmapGeo(this.$axios,e,(function(t){var e=I.a.getLatlonFromGeoRequest(t);n.showRentRecommentDiv=!0,n.selectStation=n.getSelectStationObject(e.geohash),n.refreshRentRecommend()})),this.$axios.get("/api/topic/search",{params:{terms:e,city:_.a.getCity()}}).then((function(e){t.topicsPage.results=e,t.searchAction=!0})).catch((function(t){console.log("search error:"+JSON.stringify(t))}))}}},head:function(){return{title:this.$siteTitle("90社区—出租/转租/合租找室友"),meta:[{hid:"description",name:"description",content:this.$siteDescription()},{hid:"keywords",name:"keywords",content:this.$siteKeywords()}]}}},T=(n(429),Object(v.a)(R,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"main"},[n("div",{staticClass:"container main-container left-main"},[n("client-only",[n("div",{staticClass:"left-container"},[n("div",{staticClass:"main-content"},[n("article",{staticClass:"message is-info notice-box"},[n("div",{staticClass:"message-body messge-body-override"},[n("em"),t._v("\n              1. 整合所有豆瓣租房小组帖子;  2. 提供租房发布平，"),n("strong",[t._v("租房发帖默认置顶5天;")]),t._v("\n               3. 多关键词地点搜索功能;   4.\n              点击租房群部落，可查看覆盖城市租房微信群。可加管家微信1481460329进群，请备注：租房-城市-职业\n            ")])]),t._v(" "),n("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[n("div",{staticClass:"nav-tip"},[n("a",{staticClass:"button is-small nav-btn",on:{click:function(e){return t.jumpUrl("https://www.jianshu.com/p/1850dba0604f")}}},[t._v("\n                找房攻略\n              ")]),t._v(" "),n("a",{staticClass:"button is-small nav-btn",on:{click:function(e){return t.jumpCityWechatUrl()}}},[t._v("\n                租房群部落\n              ")])])]),t._v(" "),n("div",{staticClass:"field is-grouped search-box"},[n("p",{staticClass:"control is-expanded"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.searchTerms,expression:"searchTerms"}],staticClass:"input",staticStyle:{"font-size":"small"},attrs:{type:"text",placeholder:"西二旗 回龙观（空格隔开，多关键词匹配)"},domProps:{value:t.searchTerms},on:{input:function(e){e.target.composing||(t.searchTerms=e.target.value)}}})]),t._v(" "),n("p",{staticClass:"control"},[n("button",{staticClass:"button is-primary is-small is-active",on:{click:t.search}},[t._v("\n                搜索\n              ")])])]),t._v(" "),t.showMetraDiv?n("metro-selector",{attrs:{"subways-and-regions":t.subwaysAndRegions,"on-parent-station-changed":t.onParentStationChanged,"on-child-station-changed":t.onChildStationChanged,"on-tab-changed":t.onTabChanged}}):t._e(),t._v(" "),t.showRentRecommentDiv?n("rent-recommend",{attrs:{dtype:t.dtype,"geo-station-id":t.selectStation.geoStationId,"geo-hash":t.selectStation.geoHash,"on-recommend-station-changed":t.onRecommendStationChanged}}):t._e(),t._v(" "),t.topicsPage&&t.topicsPage.results&&t.topicsPage.results.length>0?n("span",[n("topic-list",{attrs:{topics:t.topicsPage.results,"edit-path":"rent","show-ad":!0,"open-new-page":!0}}),t._v(" "),t.searchAction?t._e():n("pagination2",{attrs:{page:t.topicsPage.page,"url-prefix":t.pageAction,"parms-context":t.pageParmsContext,"on-page-changed":t.onPageChanged}})],1):n("span",[n("no-tip")],1),t._v(" "),n("back-to-top",{attrs:{right:"15%",text:"Top",visibleoffset:"500"}},[n("button",{staticClass:"btn btn-to-top",attrs:{type:"button"}},[n("font-awesome-icon",{attrs:{icon:"angle-up"}})],1)])],1)]),t._v(" "),n("div",{staticClass:"right-container"})])],1)])}),[],!1,null,"a9db8686",null));e.default=T.exports}}]);