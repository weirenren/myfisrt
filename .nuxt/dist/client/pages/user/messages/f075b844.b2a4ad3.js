(window.webpackJsonp=window.webpackJsonp||[]).push([[85],{210:function(t,e,r){},211:function(t,e,r){},214:function(t,e,r){},216:function(t,e,r){"use strict";var n={props:{page:{type:Object,default:function(){return{page:1,total:0,limit:20}},required:!0},urlPrefix:{type:String,default:"/",required:!0}},computed:{pageList:function(){var t=this.page.page-2,e=this.page.page+2,r=this.getTotalPage();if(t<=0){for(var n=[],i=1;i<=5&&i<=r;i++)n.push(i);return n}if(e>r){for(var c=[],o=r-5<=0?1:r-5;o>0&&o<=r;o++)c.push(o);return c}return[this.page.page-2,this.page.page-1,this.page.page,this.page.page+1,this.page.page+2]},previousPageUrl:function(){return this.getPreviousPageUrl()},nextPageUrl:function(){return this.getNextPageUrl()}},methods:{getNextPageUrl:function(){var t=this.page.page+1;return t>this.getTotalPage()?"":this.getPageUrl(t)},getPreviousPageUrl:function(){var t=this.page.page-1;return t<=0?"":this.getPageUrl(t)},getPageUrl:function(t){return this.page.page===t?"javascript:void(0)":this.urlPrefix+t},getTotalPage:function(){return this.page.total%this.page.limit>0?parseInt(this.page.total/this.page.limit)+1:this.page.total/this.page.limit}}},c=(r(227),r(29)),component=Object(c.a)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.page.total>0?r("nav",{staticClass:"pagination is-small",attrs:{role:"navigation","aria-label":"pagination"}},[t.previousPageUrl?r("a",{staticClass:"pagination-previous",attrs:{href:t.previousPageUrl}},[t._v("上一页")]):r("a",{staticClass:"pagination-previous",attrs:{disabled:""}},[t._v("上一页")]),t._v(" "),t.nextPageUrl?r("a",{staticClass:"pagination-previous",attrs:{href:t.nextPageUrl}},[t._v("下一页")]):r("a",{staticClass:"pagination-previous",attrs:{disabled:""}},[t._v("下一页")]),t._v(" "),r("ul",{staticClass:"pagination-list"},t._l(t.pageList,(function(p){return r("li",{key:p},[r("a",{staticClass:"pagination-link",class:{"is-current":p==t.page.page},attrs:{href:t.getPageUrl(p)}},[t._v(t._s(p))])])})),0)]):t._e()}),[],!1,null,"a3f55830",null);e.a=component.exports},219:function(t,e,r){"use strict";var n=r(210);r.n(n).a},220:function(t,e,r){"use strict";var n=r(211);r.n(n).a},221:function(t,e,r){"use strict";r(16);var n=r(2),c=(r(137),{props:{currentNodeId:{type:Number,default:0}},computed:{createTopicUrl:function(){var t="/topic/create";return this.currentNodeId&&(t+="?nodeId="+this.currentNodeId),t}}}),o=(r(219),r(29)),l=Object(o.a)(c,(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"aside-actions"})}),[],!1,null,"2af0916a",null).exports,v=r(68),d={components:{PostBtns:l},props:{user:{type:Object,required:!0}},data:function(){return{}},computed:{currentUser:function(){return this.$store.state.user.current},isOwner:function(){var t=this.$store.state.user.current;return this.user&&t&&this.user.id===t.id},isAdmin:function(){return v.a.isOwner(this.currentUser)||v.a.isAdmin(this.currentUser)}},methods:{forbidden:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$axios.post("/api/user/forbidden",{userId:t.user.id,days:7});case 3:t.user.forbidden=!0,t.$toast.success("禁言成功"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),t.$toast.error("禁言失败");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},removeForbidden:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$axios.post("/api/user/forbidden",{userId:t.user.id,days:0});case 3:t.user.forbidden=!1,t.$toast.success("取消禁言成功"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),t.$toast.error("取消禁言失败");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()}}},f=(r(220),Object(o.a)(d,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"right-container"},[t.isOwner?r("post-btns"):t._e(),t._v(" "),r("div",{staticClass:"widget"},[r("div",{staticClass:"widget-header"},[t._v("\n      "+t._s(t.user.nickname)+"\n    ")]),t._v(" "),r("div",{staticClass:"widget-content"},[r("img",{staticClass:"img-avatar",attrs:{src:t.user.smallAvatar}}),t._v(" "),t.user.description?r("div",{staticClass:"description"},[r("p",[t._v(t._s(t.user.description))])]):t._e(),t._v(" "),r("div",{staticClass:"score"},[r("i",{staticClass:"iconfont icon-score"}),t._v(" "),r("span",[t._v(t._s(t.user.score))]),t._v(" "),t.isOwner?r("a",{staticClass:"score-log",attrs:{href:"/user/scores",target:"_blank"}},[t._v("积分详情>>")]):t._e()]),t._v(" "),t.isOwner?r("ul",{staticClass:"operations"},[t._m(0),t._v(" "),t._m(1),t._v(" "),t._m(2)]):t._e(),t._v(" "),t.isAdmin?r("ul",{staticClass:"operations"},[t.user.forbidden?r("li",[r("i",{staticClass:"iconfont icon-forbidden"}),t._v(" "),r("a",{on:{click:t.removeForbidden}},[t._v(" 取消禁言")])]):r("li",[r("i",{staticClass:"iconfont icon-forbidden"}),t._v(" "),r("a",{on:{click:t.forbidden}},[t._v(" 禁言")])])]):t._e()])])],1)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("li",[e("i",{staticClass:"iconfont icon-edit"}),this._v(" "),e("a",{attrs:{href:"/user/settings"}},[this._v(" 编辑资料")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",[e("i",{staticClass:"iconfont icon-message"}),this._v(" "),e("a",{attrs:{href:"/user/messages"}},[this._v(" 消息")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",[e("i",{staticClass:"iconfont icon-favorites"}),this._v(" "),e("a",{attrs:{href:"/user/favorites"}},[this._v(" 收藏")])])}],!1,null,"3d739100",null));e.a=f.exports},227:function(t,e,r){"use strict";var n=r(214);r.n(n).a},337:function(t,e,r){},457:function(t,e,r){"use strict";var n=r(337);r.n(n).a},569:function(t,e,r){"use strict";r.r(e);r(17),r(9),r(30);var n=r(41),c=(r(16),r(2)),o=r(221),l=r(216),v={middleware:"authenticated",components:{UserCenterSidebar:o.a,Pagination:l.a},asyncData:function(t){return Object(c.a)(regeneratorRuntime.mark((function e(){var r,c,o,l,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.$axios,c=t.query,e.next=3,Promise.all([r.get("/api/user/messages?page="+(c.p||1))]);case 3:return o=e.sent,l=Object(n.a)(o,1),v=l[0],e.abrupt("return",{messagesPage:v});case 7:case"end":return e.stop()}}),e)})))()},data:function(){return{messages:[],cursor:0,hasMore:!0}},computed:{currentUser:function(){return this.$store.state.user.current}}},d=(r(457),r(29)),component=Object(d.a)(v,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("section",{staticClass:"main"},[r("div",{staticClass:"container main-container is-white left-main"},[r("div",{staticClass:"left-container"},[r("div",{staticClass:"widget"},[r("div",{staticClass:"widget-header"},[r("nav",{staticClass:"breadcrumb"},[r("ul",[t._m(0),t._v(" "),r("li",[r("a",{attrs:{href:"/user/"+t.currentUser.id}},[t._v(t._s(t.currentUser.nickname))])]),t._v(" "),t._m(1)])])]),t._v(" "),r("div",{staticClass:"widget-content"},[t.messagesPage&&t.messagesPage.results?r("ul",{staticClass:"message-list"},t._l(t.messagesPage.results,(function(e){return r("li",{key:e.messageId,staticClass:"message-item"},[r("div",{staticClass:"message-item-left"},[r("img",{staticClass:"avatar",attrs:{src:e.from.smallAvatar}})]),t._v(" "),r("div",{staticClass:"message-item-right"},[r("div",{staticClass:"message-item-meta"},[e.from.id>0?r("span",{staticClass:"nickname"},[r("a",{attrs:{href:"/user/"+e.from.id,target:"_blank"}},[t._v(t._s(e.from.nickname))])]):r("span",{staticClass:"nickname"},[r("a",{attrs:{href:"javascript:void(0)",target:"_blank"}},[t._v(t._s(e.from.nickname))])]),t._v(" "),r("span",{staticClass:"time"},[t._v(t._s(t._f("prettyDate")(e.createTime)))])]),t._v(" "),r("div",{staticClass:"content"},[r("div",{staticClass:"message-content"},[t._v("\n                    "+t._s(e.content)+"\n                    "),e.detailUrl?r("a",{staticClass:"show-more",attrs:{href:e.detailUrl,target:"_blank"}},[t._v("点击查看详情>>")]):t._e()]),t._v(" "),r("blockquote",{staticClass:"message-quote"},[t._v("\n                    "+t._s(e.quoteContent)+"\n                  ")])])])])})),0):r("div",{staticClass:"notification is-primary",staticStyle:{"margin-top":"10px"}},[t._v("\n            暂无消息\n          ")]),t._v(" "),r("pagination",{attrs:{page:t.messagesPage.page,"url-prefix":"/user/messages?p="}})],1)])]),t._v(" "),r("user-center-sidebar",{attrs:{user:t.currentUser}})],1)])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("li",[e("a",{attrs:{href:"/"}},[this._v("首页")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",{staticClass:"is-active"},[e("a",{attrs:{href:"#","aria-current":"page"}},[this._v("消息")])])}],!1,null,"560c6ebc",null);e.default=component.exports}}]);