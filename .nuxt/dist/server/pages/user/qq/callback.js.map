{"version":3,"file":"pages/user/qq/callback.js","sources":["webpack:///./pages/user/qq/callback.vue?261e","webpack:///./pages/user/qq/callback.vue?0e9d","webpack:///./pages/user/qq/callback.vue?d4af","webpack:///./pages/user/qq/callback.vue","webpack:///./pages/user/qq/callback.vue?7628","webpack:///./pages/user/qq/callback.vue?713b","webpack:///./common/utils.js"],"sourcesContent":["// Exports\nmodule.exports = {};\n","import mod from \"-!../../../node_modules/_css-loader@3.6.0@css-loader/dist/cjs.js??ref--7-oneOf-1-0!../../../node_modules/_vue-loader@15.9.3@vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--7-oneOf-1-1!../../../node_modules/_sass-loader@7.3.1@sass-loader/dist/cjs.js??ref--7-oneOf-1-2!../../../node_modules/_vue-loader@15.9.3@vue-loader/lib/index.js??vue-loader-options!./callback.vue?vue&type=style&index=0&id=79adfffc&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/_css-loader@3.6.0@css-loader/dist/cjs.js??ref--7-oneOf-1-0!../../../node_modules/_vue-loader@15.9.3@vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--7-oneOf-1-1!../../../node_modules/_sass-loader@7.3.1@sass-loader/dist/cjs.js??ref--7-oneOf-1-2!../../../node_modules/_vue-loader@15.9.3@vue-loader/lib/index.js??vue-loader-options!./callback.vue?vue&type=style&index=0&id=79adfffc&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_vm._ssrNode(((_vm.loading)?(\"<div class=\\\"loading modal is-active\\\" data-v-79adfffc><div class=\\\"modal-background\\\" data-v-79adfffc></div> <div class=\\\"modal-content\\\" data-v-79adfffc><div class=\\\"loading-animation\\\" data-v-79adfffc></div> <span class=\\\"loading-text\\\" data-v-79adfffc>登录中，请稍后...</span></div></div>\"):\"<!---->\"))])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport utils from '~/common/utils'\nexport default {\n  layout: 'no-footer',\n  asyncData({ params, query }) {\n    return {\n      code: query.code,\n      state: query.state,\n      ref: query.ref\n    }\n  },\n  data() {\n    return {\n      loading: false\n    }\n  },\n  mounted() {\n    this.callback()\n  },\n  methods: {\n    async callback() {\n      this.loading = true\n      try {\n        const user = await this.$store.dispatch('user/signinByQQ', {\n          code: this.code,\n          state: this.state\n        })\n\n        if (this.ref) {\n          // 跳到登录前\n          utils.linkTo(this.ref)\n        } else {\n          // 跳到个人主页\n          utils.linkTo('/user/' + user.id)\n        }\n      } catch (e) {\n        console.log(e)\n        this.$toast.error('登录失败：' + (e.message || e), {\n          onComplete() {\n            utils.linkTo('/user/signin')\n          }\n        })\n      } finally {\n        this.loading = false\n      }\n    }\n  },\n  head() {\n    return {\n      title: this.$siteTitle('登录处理中...')\n    }\n  }\n}\n","import mod from \"-!../../../node_modules/_babel-loader@8.1.0@babel-loader/lib/index.js??ref--2-0!../../../node_modules/_vue-loader@15.9.3@vue-loader/lib/index.js??vue-loader-options!./callback.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/_babel-loader@8.1.0@babel-loader/lib/index.js??ref--2-0!../../../node_modules/_vue-loader@15.9.3@vue-loader/lib/index.js??vue-loader-options!./callback.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./callback.vue?vue&type=template&id=79adfffc&scoped=true&\"\nimport script from \"./callback.vue?vue&type=script&lang=js&\"\nexport * from \"./callback.vue?vue&type=script&lang=js&\"\nfunction injectStyles (context) {\n  \n  var style0 = require(\"./callback.vue?vue&type=style&index=0&id=79adfffc&lang=scss&scoped=true&\")\nif (style0.__inject__) style0.__inject__(context)\n\n}\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/_vue-loader@15.9.3@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  \"79adfffc\",\n  \"4bc32a7f\"\n  \n)\n\nexport default component.exports","import Cookies from 'js-cookie'\nclass Utils {\n  getCity() {\n    // Cookies.get('city')\n    const city = Cookies.get('city')\n    if (city !== undefined) {\n      return city\n    }\n    return '北京'\n  }\n\n  setCity(city) {\n    return Cookies.set('city', city)\n  }\n\n  linkTo(path) {\n    window.location = path\n    // 这里使用$router.push会导致跳转页面之后window.vditor对象undefined，原因未知\n    // window.$nuxt.$router.push(path)\n  }\n\n  toSignin(ref) {\n    if (!ref && process.client) {\n      // 如果没配置refUrl，那么取当前地址\n      ref = window.location.pathname\n    }\n    this.linkTo('/user/signin?ref=' + encodeURIComponent(ref))\n  }\n\n  isSigninUrl(ref) {\n    return ref === '/user/signin'\n  }\n\n  isArray(sources) {\n    return Object.prototype.toString.call(sources) === '[object Array]'\n  }\n\n  isDate(sources) {\n    return (\n      {}.toString.call(sources) === '[object Date]' &&\n      sources.toString() !== 'Invalid Date' &&\n      !isNaN(sources)\n    )\n  }\n\n  isElement(sources) {\n    return !!(sources && sources.nodeName && sources.nodeType === 1)\n  }\n\n  isFunction(sources) {\n    return Object.prototype.toString.call(sources) === '[object Function]'\n  }\n\n  isNumber(sources) {\n    return (\n      Object.prototype.toString.call(sources) === '[object Number]' &&\n      isFinite(sources)\n    )\n  }\n\n  isObject(sources) {\n    return Object.prototype.toString.call(sources) === '[object Object]'\n  }\n\n  isString(sources) {\n    return Object.prototype.toString.call(sources) === '[object String]'\n  }\n\n  isBoolean(sources) {\n    return typeof sources === 'boolean'\n  }\n\n  getCityList() {\n    return ['北京', '上海', '深圳', '武汉', '杭州']\n  }\n\n  isEmpty(content) {\n    const str = content\n    if (str === '' || str === undefined) return true\n    const regu = '^[ ]+$'\n    const re = new RegExp(regu)\n    return re.test(str)\n  }\n}\nexport default new Utils()\n"],"mappings":";;;;;;AAAA;AACA;;;;;;;;;ACDA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;ACAA;AACA;AACA;;;;;;;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAHA;AAKA;AACA;AAAA;AACA;AACA;AADA;AAGA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAFA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAJA;AAKA;AACA;AACA;AACA;AACA;AA3BA;AACA;AA2BA;AACA;AACA;AADA;AAGA;AACA;AAlDA;;ACdA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACvBA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAlFA;AACA;AAkFA;;;;A","sourceRoot":""}