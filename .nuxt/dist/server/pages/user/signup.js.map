{"version":3,"file":"pages/user/signup.js","sources":["webpack:///./pages/user/signup.vue?4c98","webpack:///./pages/user/signup.vue","webpack:///./pages/user/signup.vue?a364","webpack:///./pages/user/signup.vue?0bb2","webpack:///./common/utils.js"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('section',{staticClass:\"main\"},[_vm._ssrNode(\"<div class=\\\"container\\\" data-v-9136fa7e>\",\"</div>\",[_vm._ssrNode(\"<div class=\\\"main-body\\\" data-v-9136fa7e>\",\"</div>\",[_vm._ssrNode(\"<div class=\\\"widget\\\" data-v-9136fa7e>\",\"</div>\",[_vm._ssrNode(\"<div class=\\\"widget-header\\\" data-v-9136fa7e>\\n          注册\\n        </div> \"),_vm._ssrNode(\"<div class=\\\"widget-content\\\" data-v-9136fa7e>\",\"</div>\",[_vm._ssrNode(\"<div class=\\\"field\\\" data-v-9136fa7e><label class=\\\"label\\\" data-v-9136fa7e>昵称</label> <div class=\\\"control has-icons-left\\\" data-v-9136fa7e><input type=\\\"text\\\" placeholder=\\\"请输入昵称\\\"\"+(_vm._ssrAttr(\"value\",(_vm.nickname)))+\" class=\\\"input is-success\\\" data-v-9136fa7e> <span class=\\\"icon is-small is-left\\\" data-v-9136fa7e><i class=\\\"iconfont icon-username\\\" data-v-9136fa7e></i></span></div></div> <div class=\\\"field\\\" data-v-9136fa7e><label class=\\\"label\\\" data-v-9136fa7e>邮箱</label> <div class=\\\"control has-icons-left\\\" data-v-9136fa7e><input type=\\\"text\\\" placeholder=\\\"请输入邮箱\\\"\"+(_vm._ssrAttr(\"value\",(_vm.email)))+\" class=\\\"input is-success\\\" data-v-9136fa7e> <span class=\\\"icon is-small is-left\\\" data-v-9136fa7e><i class=\\\"iconfont icon-email\\\" data-v-9136fa7e></i></span></div></div> <div class=\\\"field\\\" data-v-9136fa7e><label class=\\\"label\\\" data-v-9136fa7e>密码</label> <div class=\\\"control has-icons-left\\\" data-v-9136fa7e><input type=\\\"password\\\" placeholder=\\\"请输入密码\\\"\"+(_vm._ssrAttr(\"value\",(_vm.password)))+\" class=\\\"input\\\" data-v-9136fa7e> <span class=\\\"icon is-small is-left\\\" data-v-9136fa7e><i class=\\\"iconfont icon-password\\\" data-v-9136fa7e></i></span></div></div> <div class=\\\"field\\\" data-v-9136fa7e><label class=\\\"label\\\" data-v-9136fa7e>确认密码</label> <div class=\\\"control has-icons-left\\\" data-v-9136fa7e><input type=\\\"password\\\" placeholder=\\\"请再次输入密码\\\"\"+(_vm._ssrAttr(\"value\",(_vm.rePassword)))+\" class=\\\"input\\\" data-v-9136fa7e> <span class=\\\"icon is-small is-left\\\" data-v-9136fa7e><i class=\\\"iconfont icon-password\\\" data-v-9136fa7e></i></span></div></div> <div class=\\\"field\\\" data-v-9136fa7e><label class=\\\"label\\\" data-v-9136fa7e>验证码</label> <div class=\\\"control has-icons-left\\\" data-v-9136fa7e><div class=\\\"field is-horizontal\\\" data-v-9136fa7e><div class=\\\"field\\\" style=\\\"width:100%;\\\" data-v-9136fa7e><input type=\\\"text\\\" placeholder=\\\"验证码\\\"\"+(_vm._ssrAttr(\"value\",(_vm.captchaCode)))+\" class=\\\"input\\\" data-v-9136fa7e> <span class=\\\"icon is-small is-left\\\" data-v-9136fa7e><i class=\\\"iconfont icon-captcha\\\" data-v-9136fa7e></i></span></div> \"+((_vm.captchaUrl)?(\"<div class=\\\"field\\\" data-v-9136fa7e><a data-v-9136fa7e><img\"+(_vm._ssrAttr(\"src\",_vm.captchaUrl))+\" style=\\\"height: 40px;\\\" data-v-9136fa7e></a></div>\"):\"<!---->\")+\"</div></div></div> \"),_vm._ssrNode(\"<div class=\\\"field\\\" data-v-9136fa7e>\",\"</div>\",[_vm._ssrNode(\"<div class=\\\"control\\\" data-v-9136fa7e>\",\"</div>\",[_vm._ssrNode(\"<button class=\\\"button is-success\\\" data-v-9136fa7e>\\n                注册\\n              </button> \"),_c('nuxt-link',{staticClass:\"button is-text\",attrs:{\"to\":\"/user/signin\"}},[_vm._v(\"\\n                已有账号，前往登录>>\\n              \")])],2)])],2)],2)])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport utils from '~/common/utils'\n// import GithubLogin from '~/components/GithubLogin'\n// import QqLogin from '~/components/QqLogin'\nexport default {\n  components: {\n    // GithubLogin,\n    // QqLogin\n  },\n  asyncData({ params, query }) {\n    return {\n      ref: query.ref\n    }\n  },\n  data() {\n    return {\n      nickname: '',\n      email: '',\n      password: '',\n      rePassword: '',\n      captchaId: '',\n      captchaUrl: '',\n      captchaCode: ''\n    }\n  },\n  mounted() {\n    this.showCaptcha()\n  },\n  methods: {\n    async signup() {\n      try {\n        await this.$store.dispatch('user/signup', {\n          captchaId: this.captchaId,\n          captchaCode: this.captchaCode,\n          nickname: this.nickname,\n          email: this.email,\n          password: this.password,\n          rePassword: this.rePassword,\n          ref: this.ref\n        })\n        if (this.ref) {\n          // 跳到登录前\n          utils.linkTo(this.ref)\n        } else {\n          // 跳到个人主页\n          utils.linkTo('/user/settings')\n        }\n      } catch (err) {\n        this.$toast.error(err.message || err)\n        await this.showCaptcha()\n      }\n    },\n    async showCaptcha() {\n      try {\n        const ret = await this.$axios.get('/api/captcha/request')\n        this.captchaId = ret.captchaId\n        this.captchaUrl = ret.captchaUrl\n        this.captchaCode = ''\n      } catch (e) {\n        this.$toast.error(e.message || e)\n      }\n    }\n  },\n  head() {\n    return {\n      title: this.$siteTitle('注册')\n    }\n  }\n}\n","import mod from \"-!../../node_modules/_babel-loader@8.1.0@babel-loader/lib/index.js??ref--2-0!../../node_modules/_vue-loader@15.9.3@vue-loader/lib/index.js??vue-loader-options!./signup.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/_babel-loader@8.1.0@babel-loader/lib/index.js??ref--2-0!../../node_modules/_vue-loader@15.9.3@vue-loader/lib/index.js??vue-loader-options!./signup.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./signup.vue?vue&type=template&id=9136fa7e&scoped=true&\"\nimport script from \"./signup.vue?vue&type=script&lang=js&\"\nexport * from \"./signup.vue?vue&type=script&lang=js&\"\nfunction injectStyles (context) {\n  \n  \n}\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/_vue-loader@15.9.3@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  \"9136fa7e\",\n  \"583e5d3d\"\n  \n)\n\nexport default component.exports","import Cookies from 'js-cookie'\nclass Utils {\n  getCity() {\n    // Cookies.get('city')\n    const city = Cookies.get('city')\n    if (city !== undefined) {\n      return city\n    }\n    return '北京'\n  }\n\n  setCity(city) {\n    return Cookies.set('city', city)\n  }\n\n  linkTo(path) {\n    window.location = path\n    // 这里使用$router.push会导致跳转页面之后window.vditor对象undefined，原因未知\n    // window.$nuxt.$router.push(path)\n  }\n\n  toSignin(ref) {\n    if (!ref && process.client) {\n      // 如果没配置refUrl，那么取当前地址\n      ref = window.location.pathname\n    }\n    this.linkTo('/user/signin?ref=' + encodeURIComponent(ref))\n  }\n\n  isSigninUrl(ref) {\n    return ref === '/user/signin'\n  }\n\n  isArray(sources) {\n    return Object.prototype.toString.call(sources) === '[object Array]'\n  }\n\n  isDate(sources) {\n    return (\n      {}.toString.call(sources) === '[object Date]' &&\n      sources.toString() !== 'Invalid Date' &&\n      !isNaN(sources)\n    )\n  }\n\n  isElement(sources) {\n    return !!(sources && sources.nodeName && sources.nodeType === 1)\n  }\n\n  isFunction(sources) {\n    return Object.prototype.toString.call(sources) === '[object Function]'\n  }\n\n  isNumber(sources) {\n    return (\n      Object.prototype.toString.call(sources) === '[object Number]' &&\n      isFinite(sources)\n    )\n  }\n\n  isObject(sources) {\n    return Object.prototype.toString.call(sources) === '[object Object]'\n  }\n\n  isString(sources) {\n    return Object.prototype.toString.call(sources) === '[object String]'\n  }\n\n  isBoolean(sources) {\n    return typeof sources === 'boolean'\n  }\n\n  getCityList() {\n    return ['北京', '上海', '深圳', '武汉', '杭州']\n  }\n\n  isEmpty(content) {\n    const str = content\n    if (str === '' || str === undefined) return true\n    const regu = '^[ ]+$'\n    const re = new RegExp(regu)\n    return re.test(str)\n  }\n}\nexport default new Utils()\n"],"mappings":";;;;;;;;;;;AAAA;AACA;AACA;;;;;;;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AAAA;AACA;AAEA;AAFA;AACA;AAGA;AAAA;AAAA;AAAA;AACA;AACA;AADA;AAGA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;AASA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;AACA;AAQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAlCA;AACA;AAkCA;AACA;AACA;AADA;AAGA;AACA;AAhEA;;ACzHA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACrBA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAlFA;AACA;AAkFA;;;;A","sourceRoot":""}